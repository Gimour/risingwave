version: '3.8'

services:
  message_queue:
    extends:
      file: ../../docker/docker-compose-with-minio.yml
      service: message_queue

  ingestor:
    image: "docker.vectorized.io/vectorized/redpanda:latest"
    volumes:
      - './records.bin:/data/records.bin'
    depends_on:
      - message_queue
    command:
      - topic produce --brokers message_queue:29092 'alltypes' < /data/records.bin

volumes:
  redpandadata:
    driver: local
